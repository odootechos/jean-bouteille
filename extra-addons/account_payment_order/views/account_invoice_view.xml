<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="invoice_form" model="ir.ui.view">
        <field name="name">account_payment_order.invoice_form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_register_payment']" position="after">
                <button name="create_account_payment_line" type="object"
                    string="Add to Debit Order"
                    groups="account_payment_order.group_account_payment"
                    attrs="{'invisible': ['|', ('payment_order_ok', '=', False), ('state', '!=', 'open')]}"/>
            </xpath>
            <xpath expr="//field[@name='payment_id']" position="after">
                <field name="payment_order_ok" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='payment_reference']" position="before">
                  <field name="reference_type" required="1" nolabel="1"  attrs="{'readonly':[('state','!=','draft')]}"/>
            </xpath>
        </field>
    </record>
    <act_window id="account_invoice_create_account_payment_line_action"
        multi="True"
        key2="client_action_multi"
        name="Add to Payment/Debit Order"
        res_model="account.move.payment.line.multi"
        src_model="account.move"
        view_mode="form"
        target="new"/>
</odoo>
